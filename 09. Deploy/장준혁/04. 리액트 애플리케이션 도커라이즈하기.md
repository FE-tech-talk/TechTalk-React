## 4. 리액트 애플리케이션 도커라이즈하기

리액트, Next 애플리케이션을 쉽고 빠르게 배포할 수 있으나 자유롭게 커스터마이징하는 데는 제약이 있다.
NGINX 관련 설정을 추가하고 싶다 가정하면 대부분의 경우 추가할 수 있는 기능을 제공하지 않고 비용도 유연하지 못하다.

과거에는 웹 애플리케이션을 배포하기 위해 직접 장비를 준비하고 구동에 필요한 파일을 설치하고 소스를 받았다면 요즘은 도커를 이용하여 하나의 컨테이너로 만들어 빠르게 배포한다.

### 리액트 앱을 도커라이즈하는 방법

도커는 서버와 애플리케이션에 적절한 리소스를 받고 운영체제를 설치하고 Node.js를 설치하고 빌드하는 과정을 한번에 할 수 있다.
'컨테이너'라는 단위로 패키징하여 애플리케이션이 실행될 수 있도록 도와준다. 또한 독립된 환경에서 항상 일관되게 실행할 수 있다.

#### 도커 용어

- 이미지 : 컨테이너를 만드는 데 사용되는 템플릿, Dockerfile을 이용할 수 있다.
- 컨테이너 : 도커의 이미지를 실행한 상태
- Dockerfile : 어떤 이미지 파일을 만들지 정의하는 파일
- 태그 : 이미지를 식별할 수 있는 레이블
- 리포지터리 : 이미지를 모아두는 저장소
- 레지스트리 : 리포지터리에 접근할 수 있게 해주는 서비스

#### 자주 쓰는 도커 cli 명령어

- docker build : Dockerfile을 기준으로 이미지를 빌드한다
- docker push : 이미지나 리포지터리를 도커 레지스트리에 업로드하는 과정
- docker tag : 이미지에 태그를 생성하는 명령어
- docker inspect : 이미지나 컨테이너 세부 정보를 출력
- docker run : 이미지를 기반으로 새로운 컨테이너 생성
- docker ps : 가동 중인 컨테이너 목록 확인
- docker rm : docker rm {이미지명} 으로 컨테이너를 삭제할 수 있다. 실행 중이라면 docker stop {이미지명}으로 중지시켜야한다.

GUI 인터페이스도 제공한다.

#### Dockerfile

- FROM : 어떤 베이스 이미지에서 실행될지를 결정한다
- WORKDIR : 작업을 수행하고자 하는 기본 디렉터리
- COPY : 파일 복사 명령어
- RUN : 명령어 실행 (ex. RUN npm run build)
- EXPOSE : 컨테이너가 사용할 포트를 지정한다
- ENTRYPOINT : 컨테이너가 시작됐을 때 실행하는 명령어

### 도커로 만든 이미지 배포하기

GUI의 Create repository를 이용하여 도커 허브로 배포 가능하다.
도커 이미지를 아마존 웹 서비스의 Elastic Container Repository, 구글 클라우드 플랫폼의 Container Registry 또한 업로드가 가능하지만 약간의 비용이 든다.
