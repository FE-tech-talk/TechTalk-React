# 애플리케이션에서 확인하기

## create-next-app

NextWebVitalsMetric 메서드로 성능 측정
웹 표준 지표 이외에 3가지 추가적인 사용자 지표가 존재한다.

1. Next.js-hydration : 페이지가 서버 사이드에서 렌더링되어 하이드레이션하는 데 걸린 시간
2. Next.js-route-change-to-render : 페에지가 경로를 변경한 후 페이지를 렌더링을 시작하는데 걸리는 시간
3. Next.js-render : 경로 변경이 완료된 후 페이지를 렌더링하는 데 걸린 시간

## Light House

구글에서 제공하는 웹 페이지 성능 측정 도구, 핵심 웹 지표, 접근성, PWA, SEO등등의 요소들을 측정하고 점검한다.

다른 확장 프로그램이 관여하지 못하게 시크릿 창에서 확인하자.

### 탐색 모드

페이지에 접속했을 때부터 페이지 로딩이 완료될 때까지의 성능을 측정하는 모드

#### 1. 성능

![](Pasted%20image%2020240716093220.png)

FCP, LCP, CLS 외에 3가지 추가지 지표

1. Time to Interaction
2. Speed Index : 콘텐츠가 얼마나 빨리 시각적으로 표시되는지 확인
3. Total Blocking Time : 메인 스레드에서 특정 시간 이상 실행되는 작업 (FCP(First Contentful Paint)부터 TTI(Time To Interaction)까지의 시간)
 
#### 2. 접근성

스크린 리더가 잘 이해할 수 있도록 HTML, CSS로 잘 대비되어 있는지를 나타낸 지표

#### 3. 권장사항

보안, 표준 모드, 최신 라이브러리, 소스 맵

1. CSP가 XSS 공격에 효과적인지 확인 (Content Securityu Policy : 웹 사이트에서 호출할 수 있는 컨텐츠를 제한하는 정책)
2. 다양한 보안 취약점, 권장사항들의 예시가 존재한다.

#### 4. 검색엔진 최적화

구글과 같은 검색엔진이 쉽게 웹페이지 정보를 가져가서 공개할 수 있도록 최적화돼 있는지를 확인하는 것

1. 문서를 크롤링하기 쉽게 만들었는지
2. robots.txt가 유효한지
3. 이미지와 링크에 설명 문자가 존재하는지
4. `<meta></meta>`나 `<title></title>` 등으로 페이지의 정보를 빠르게 확인할 수 있는가

### 기간 모드 (Timespan)

![](Pasted%20image%2020240716114518.png)

웹페이지를 탐색하는 동안 지표를 측정하는 것

개발자 도구에서 수정이 필요한 내용을 확인할 수 있다.

이때 앞에서 볼 수 없었던 내용 두 가지를 확인할 수 있는데, View Trace과 Tree Map이다.

#### View Trace

클릭하면 다음처럼 performance로 이동한다.

![](Pasted%20image%2020240716115201.png)

웹 성능을 추적한 기간을 성능 탭에서 보여준다. 시간의 흐름에 따라 어떻게 로딩됐는지 보여준다.

#### Tree Map

페이지를 불러올 때 함께 로딩한 모든 리소스를 함께 모아서 볼 수 있는 곳이다.

웹페이지의 전체 JS Resource 중 어떠한 파일이 전체 데이터 로딩 중 어느 정도를 차지했는지를 비율로 확인할 수 있다.

source에서 검색해서 어떤건지 찾아낼 수도 있다.

### 스냅샷

탐색모드와 유사하지만 차이점은 현재 페이지 상태를 기준으로 분석

현재 상태에서 검색 엔진의 최적화, 접근성, 성능 등을 분석할 수 있다.

페이지 로딩이 아닌 특정 페이지 특정 상태를 기준으로 분석 시 스냅샷 모드 사용

기간 분석이 아니기 때문에 분석할 수 있는 내용이 제한적이다.

## WebPageTest

웹사이트 성능을 분석하는 도구이자 다양한 기능을 포함한다.
거리가 먼 서버를 기준으로 테스트하기 때문에 성능 지표가 기본 크롬 개발자 도구보다 안 좋을 수 있다.
### 분석 도구 종류

#### 1. Site Performance : 웹 사이트 성능을 분석
#### 2. Core Web Vitals : 웹사이트의 핵심 웹 지표를 확인하기 위한 도구
#### 3. Lighthouse : 구글 라이트하우스 도구
#### 4. Visual Comparison : 2개 이상의 사이트를 동시에 실행해 시간의 흐름에 따른 로딩 과정을 비교하는 도구
#### 5. Traceroute : 네트워크 경로를 확인하는 도구

### Site Performance를 탐구해보자.

www.webpagetest.org에 접속해서 탐구가능하다.

테스트는 총 3번 이뤄지고 서로 다른 결과를 확인할 수 있다.

### Performance Summary

![](Pasted%20image%2020240716120409.png)

##### 1. Is it Quick

웹사이트가 충분히 빠른지 평가한다. 최초 바이트까지의 시간이 짧은지, 콘텐츠 렌더링이 즉각적으로 일어나는지, 최대 콘텐츠풀 페인트 시간이 합리적인지를 확인한다.

##### 2. Is it Usable

1. 이미지 비율 부재로 인한 레이아웃 이동 가능성 여부
2. 메인 스레드가 멈춰있어서는 안된다. jss 크기를 줄이자.
3. meta: viewport가  있어야 블라우저가 해당 페이지의 면적 및 비율을 어떻게 제어할지를 정의한다.

##### 3. Is it Resilient

1. 렌더링을 막는 제3자 라이브러리 요청이 없어야 한다.
2. Synk에 검출된 보안 위협이 없어야 한다.
3. HTTPS 사용
4. HTML과 최종 결과물 html 사이에 크기 차이가 적어야 한다.

#### 4. Page Performance Metrics

시간의 흐름에 따라 웹페이지가 어떤 식으로 렌더링 됐는지와 함께 시간 지표를 분석해준다.

#### 5. Individual Runs

![](Pasted%20image%2020240716120843.png)

각 실행별로 어떠한 결과를 보여주는지 확인

### Filmstrip

![](Pasted%20image%2020240716121739.png)

웹사이트를 필름 보는 것처럼 시간의 흐름에 따라 어떻게 웹사이트가 그려졌는지 볼 수 있는 메뉴

https://www.toptal.com/developers/css/sprite-generator/
CSS sprite를 이용해서 이미지들을 하나의 이미지로 합쳐서 최적화하는 기법

단, 대문 사진의 경우 img로 직접 박아 넣어서 LCP 지표에 영향이 적도록 한다.

#### Details

![](Pasted%20image%2020240716125603.png)

Filmstrip에서 보여준 내용을 자세하게 보여주는 영역

#### Web Vitals

LCP, CLS, TBT에 대한 내용 확인

#### Optimizations

리소스 최적화 확인

1. Keep-Alive 설정으로 서버와의 연결을 계속 유지하고 있는지
2. Gzip으로 리소스를 압축하고 있는지
3. 이미지를 적절하게 압축했는지
4. Progressive JPEG으로 JPEG이미지를 렌더링하고 있는지
5. 리소스 캐시 정책이 올바르게 수립돼 있는지
6. 리소스가 CDN을 거치고 있는지

#### Content

웹사이트에서 제공하는 콘텐츠, 애셋을 종류별로 묶어 통계를 보여준다.

시간의 흐름에 따라 렌더링을 거치면서 또 어떻게 애셋을 불러오는지도 확인

#### Domains

Content에서 보여준 애셋들이 어느 도메인에서 왔는지를 도메인별로 묶어서 확인

#### Console log

사용자가 웹페이지에 접속했을 때 console.log로 무엇이 기록됐는지 확인할 수 있다.

#### Detected Technologies

웹사이트를 개발하는 데 사용된 기술을 확인할 수 있는 메뉴

#### Main-thread Processing

메인 스레드가 어떤 작업을 처리했는지 확인할 수 있다.

1. Processing Breakdown : 메인 스레드의 작업을 Scripting, Layout, Loading, Painting 기타 이렇게 다섯가지로 분류해서 알려준다. (리소스를 기다리는 Idle time은 집계에 포함되지 않는다.)
2. Timing Breakdown : Idle time을 포함해 메인 스레드의 작업을 확인

#### Lighthouse Report

구글 라이트하우스 리포트 확인

### Chrome Dev Tool

우선 기본은 secret mode로 키는 것

#### 성능 통계

![](Pasted%20image%2020240717114955.png)

위에서 보다시피 2024에 deprecated된다고 한다. 넘어가자

#### 성능

![](Pasted%20image%2020240717120559.png)

성능 통계 이전에 있었으며 성능 통계보다 좀 더 어렵고 복잡하지만 자세한 정보를 확인할 수 있다.

![](Pasted%20image%2020240717133554.png)

##### 메뉴 (설정)

![](Pasted%20image%2020240717133619.png)

왼쪽부터 보면 기록하기, 새로고침 후 성능 측정, 스로틀링, 측정 프로필 저장, 불러오기 등등이 있다.

##### 요약

![](Pasted%20image%2020240717133846.png)

측정 기간의 CPU, 네트워크 요청, 스크린샷, 메모리 점유율 등을 요약해서 볼 수 있다.

##### 네트워크

![](Pasted%20image%2020240717134740.png)

성능 측정 기간 동안에 발생한 모든 네트워크 요청 확인

가장 위가 우선순위가 가장 높은 요청이다.